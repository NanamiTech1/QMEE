knitr::opts_chunk$set(echo = TRUE)
options(digits  = 3)
# install.packages("car")
# install.packages("geomorph")
library(car)
source("./MLM_Dworkin.R")
ls()
dll_data = read.csv("http://datadryad.org/bitstream/handle/10255/dryad.8377/dll.csv", header=TRUE)
summary(dll_data)
str(dll_data)
dim(dll_data)
head(dll_data)
dll_data <- na.omit(dll_data)
dim(dll_data)
dll_data$genotype <- relevel(dll_data$genotype, "wt")
levels(dll_data$genotype)
dll_data$temp <- as.factor(dll_data$temp)
cov(dll_data[ ,5:8])
cor(dll_data[, 5:8])
scatterplotMatrix( ~ femur + tibia + tarsus + SCT | interaction(genotype, temp),
ellipse = TRUE, data = dll_data, gap = 0,
plot.points = F)
eig_vals <- svd(cov(dll_data[, 5:8]))$d
det(cov(dll_data[, 5:8]))
prod(eig_vals)
sum(eig_vals)
sum(diag(cov(dll_data[, 5:8])))
dll_data$femur_s <- scale(dll_data$femur)
dll_data$tibia_s <- scale(dll_data$tibia)
dll_data$tarsus_s <- scale(dll_data$tarsus)
dll_data$SCT_s <- scale(dll_data$SCT)
apply(dll_data[,9:12], 2, sd)
apply(dll_data[,9:12], 2, mean)  ## very small ~ 0
round(apply(dll_data[,9:12], 2, mean))  ## very small ~ 0
cov(dll_data[,9:12])
cor(dll_data[,9:12])
summary(manova(mlm_fit1),
test = "Wilks")
mlm_fit1 <- lm(as.matrix(dll_data[,9:12]) ~ genotype, data = dll_data)
class(mlm_fit1)
summary(mlm_fit1)
summary(manova(mlm_fit1))
summary(manova(mlm_fit1),
test = "Wilks")
coef(mlm_fit1)
# Length/magnitude (L2 norm) of the vector
sqrt(t(coef(mlm_fit1)[2,]) %*% coef(mlm_fit1)[2,])
# or equivalently
sqrt(sum(coef(mlm_fit1)[2,]^2))
# Length/magnitude (L2 norm) of the vector
sqrt(t(coef(mlm_fit1)[2,]) %*% coef(mlm_fit1)[2,])
# or equivalently
sqrt(sum(coef(mlm_fit1)[2,]^2))
PD(coef(mlm_fit1)[2,])
sum(diag(cov(dll_data[,9:12])))
sum(diag(cov(mlm_fit1$fitted)))
sum(diag(cov(mlm_fit1$fitted)))/sum(diag(cov(dll_data[,9:12])))
sum(diag(cov(mlm_fit1$fitted)))/sum(diag(cov(dll_data[,9:12])))
shapeRsq(mlm_fit1)
mlm_fit2 <- procD.lm(f1 = dll_data[, 9:12] ~ genotype, data = dll_data, iter = 2000 )
library(geomorph)
mlm_fit2 <- procD.lm(f1 = dll_data[, 9:12] ~ genotype,
data = dll_data, iter = 2000 )
summary(mlm_fit2)
coef(mlm_fit2)
mlm_fit4 <- lm(as.matrix(dll_data[,9:12]) ~ temp + genotype, data = dll_data)
mlm_fit5 <- lm(as.matrix(dll_data[,9:12]) ~ temp*genotype, data = dll_data)
Anova(mlm_fit5)
mlm_fit4_dist <- procD.lm(dll_data[,9:12] ~ genotype*temp,
data = dll_data, iter = 2000)
summary(mlm_fit4_dist)
PD(coef(mlm_fit5)[2,])
PD(coef(mlm_fit5)[3,])
PD(coef(mlm_fit5)[4,])
shapeRsq(mlm_fit4)
shapePRsq(mlm_fit4)
shapePRsq(mlm_fit5)
shapeRsq(mlm_fit4)
shapePRsq(mlm_fit4)
