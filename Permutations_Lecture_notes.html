<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Jonathan Dushoff" />
  <title>Permutations lecture</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="qmee.css" type="text/css" />
</head>
<body>
<header class="site-header">
<div class="wrapper">
	<h1 class="title">
		<a href="index.html">Biology 708, McMaster University</a>
	</h1>
	<div style="text-align:center">
		<img src="http://imgs.xkcd.com/comics/self_description.png">
	</div>
</div>
</header>
<div id="header">
<h1 class="title">Permutations lecture</h1>
<h2 class="author">Jonathan Dushoff</h2>
</div>
<h1 id="introduction">Introduction</h1>
<h2 id="permutation-approach">Permutation approach</h2>
<ul>
<li><p>The key frequentist question is:</p></li>
<li>could this effect be generated by chance (under the null</li>
<li><p>hypothesis)</p></li>
<li>Permutation tests provide a natural, intuitive way to test a</li>
<li><p>wide range of such hypotheses:</p></li>
<li>If we hypothesize that two things are interchangeable, what</li>
<li><p>happens if we interchange them?</p></li>
</ul>
<h1 id="examples">Examples</h1>
<h2 id="counting-ant-colonies">[[Counting ant colonies]]</h2>
<ul>
<li>We do an exhaustive survey of ant colonies in a forest habitat</li>
<li>and an old-field habitat. This is how many colonies we find in</li>
<li><p>each survey plot:</p></li>
<li><p>Forest: 9, 6, 4, 6, 7, 10</p></li>
<li><p>Field: 12, 9, 12, 10</p></li>
<li><p>Field seems to have more ant colonies</p></li>
<li><p>Could this result be due to chance?</p></li>
</ul>
<h2 id="permutation-testing">Permutation testing</h2>
<ul>
<li>Choose a statistic that reflects the effect you are trying to</li>
<li><p>measure</p></li>
<li><p>e.g., mean, median, geometric mean</p></li>
<li>Compared the observed value of the statistic with a null</li>
<li>distribution, generated by interchanging things that should be</li>
<li><p>interchangeable under your null hypothesis</p></li>
</ul>
<h2 id="field-and-forest-ants">Field and forest ants</h2>
<ul>
<li><p>Total of 210 possible permutations</p></li>
<li><p>5 have <code>Field mean - Forest mean</code> <br /><span class="math display">≥3.75</span><br /></p></li>
<li><p>What is our P value?</p></li>
</ul>
<h2 id="ties-and-tails">Ties and tails</h2>
<ul>
<li>“Ties” (permutations with a statistic equal to the observed</li>
<li><p>statistic) ‘’count’’ against significance</p></li>
<li><p>Ties are evidence against our observation being unusual</p></li>
<li>The best way to do a two-tailed test is to calculate a</li>
<li>one-tailed P value for the observed effect, and then double</li>
<li><p>the P value</p></li>
<li>Classic tests assume everything is symmetric, so people</li>
<li>often don’t need to think about this point. And when they</li>
<li><p>do, they often get it wrong</p></li>
</ul>
<h2 id="how-should-we-interpret-our-result">How should we interpret our result?</h2>
<ul>
<li><p>We have assumed nothing about the distribution of ant nests</p></li>
<li>What is the best way to interpret our significant permutation</li>
<li><p>result?</p></li>
<li>The difference in means we observe (<code>Field mean</code> &gt;</li>
<li><code>Forest mean</code>) is due to something real about the</li>
<li><p>systems (ie., not due to chance).</p></li>
<li>‘’Note:’’ if we want to conclude that the field mean is</li>
<li><p>‘’greater’’, we need to assume something about distributions</p></li>
<li>‘’Note:’’ we only used one forest habitat and one old-field</li>
<li><p>habitat. What does this mean about our conclusions?</p></li>
</ul>
<h2 id="which-statistic-should-we-use">Which statistic should we use?</h2>
<ul>
<li><p>We can use any statistic we want, and get a valid test</p></li>
<li><p>Means tend to have more power than medians</p></li>
<li>Transformations that make the data more normal also tend to</li>
<li><p>increase power</p></li>
<li><pre><code>Using the geometric mean is equivalent to what</code></pre></li>
<li><pre><code>transformation?</code></pre></li>
<li>We are not allowed to try different statistics until one</li>
<li><p>works. Why not?</p></li>
</ul>
<h2 id="ant-colony-distributions">Ant colony distributions</h2>
<ul>
<li>Within each habitat, we can ask whether there is evidence that</li>
<li><p>ant nests are aggregated, or distributed regularly?</p></li>
<li>In other words, do they cluster, or avoid each other? Or</li>
<li><p>can’t we tell?</p></li>
<li>A permutation approach would test this by assigning nests</li>
<li><p>randomly to plots to generate a null distribution</p></li>
</ul>
<h2 id="pond-nutrients">Pond nutrients</h2>
<ul>
<li>We measure correlations between a species of algae and</li>
<li>nitrogen and phosphorous levels in natural ponds. Thus, we</li>
<li><p>have a data frame showing N, P and A (for algae).</p></li>
<li>What kinds of tests could we do to see whether the algae are</li>
<li><p>correlated with nutrient levels?</p></li>
</ul>
<h1 id="methodology">Methodology</h1>
<h2 id="monte-carlo">Monte Carlo</h2>
<ul>
<li>In the distribution example, we would like to test each</li>
<li><p>possible random assignment of nests to plots</p></li>
<li><p>This is impossible (there are too many permutations)</p></li>
<li><p>We therefore do a few thousand samples at random</p></li>
<li><p>We can treat this as a valid frequentist test</p></li>
<li>Or we can use classic methods to evaluate our results and</li>
<li><p>see how confident we are about our P value</p></li>
</ul>
<h2 id="correlations">Correlations</h2>
<ul>
<li>With permutation tests, we can use any kind of prediction</li>
<li><p>model, any statistic of prediction and any null hypothesis</p></li>
<li>Interchange things that should be interchangeable under</li>
<li><p>null hypothesis</p></li>
<li>How likely is it that we would observe a prediction as good</li>
<li>or better as the one we have, under the null hypothesis</li>
<li><p>that <br /><span class="math display"><em>x</em></span><br /> is interchangeable?</p></li>
</ul>
<h2 id="time-and-space">Time and space</h2>
<ul>
<li><p>[[Wikipedia:Mantel test | Mantel tests]] are permutation tests</p></li>
<li><p>So is Fisher’s exact test</p></li>
<li><p>[http://www.pnas.org/content/104/18/7717.full Rabies examples]</p></li>
<li><p>[[Media:Weighted_Mantel.jpg | Picture]]</p></li>
</ul>
<h1 id="more-applications">More applications</h1>
<h2 id="detailed-models-of-evolution">Detailed models of evolution</h2>
<ul>
<li>Infer a tree and then ask what happens if we relabel</li>
<li><p>nucleotides at each site, or move mutations around the tree</p></li>
<li>Ask if there are differences between nucleotide preference in</li>
<li><p>flu evolution by “relabeling” nucleotides</p></li>
</ul>
<h2 id="animal-behavior">Animal behavior</h2>
<ul>
<li>Observe behavior of different individual animals. Evaluate</li>
<li>observed statistics of (for example) tendency of bachelors to</li>
<li><p>wander off from groups</p></li>
<li><p>Classic tests don’t account for individual propensities</p></li>
<li><p>Switch whole “timelines” from one individual to another</p></li>
</ul>
<h1 id="confidence-intervals">Confidence intervals</h1>
<ul>
<li><p>The strength of permutation tests is also a weakness</p></li>
<li>Without assumptions about distributions, it’s not possible to</li>
<li><p>get confidence intervals</p></li>
<li>The field of getting confidence intervals from permutation</li>
<li><p>tests is still developing</p></li>
<li><p>Much can be done … but not without assumptions</p></li>
</ul>
<h2 id="medians">Medians</h2>
<ul>
<li>Permutation tests are well suited to comparing medians (and</li>
<li>other quantiles), because these can be evaluated without</li>
<li><p>distributional assumptions</p></li>
<li><p>This approach is related to rank tests</p></li>
</ul>
<h2 id="means">Means</h2>
<ul>
<li>We can obtain confidence intervals for a single mean if we</li>
<li><p>assume that the data are drawn from a symmetric distribution</p></li>
<li><p>It may be good to transform first</p></li>
<li>We can obtain confidence intervals for the difference between</li>
<li>two means if we assume that the distributions are identical</li>
<li><p>except for a ‘shift’</p></li>
<li><p>It may be good to transform first</p></li>
</ul>
<h2 id="correlations-1">Correlations</h2>
<ul>
<li>We can obtain confidence intervals for regression coefficients</li>
<li>if we assume that the true relationship between the variables</li>
<li><p>is linear</p></li>
<li><p>It may be good to transform first</p></li>
</ul>
<h1 id="summary">Summary</h1>
<h2 id="advantages">Advantages:</h2>
<ul>
<li><p>General applicability</p></li>
<li><p>Conceptual clarity</p></li>
<li><p>Flexibility</p></li>
<li><p>Fewer assumptions</p></li>
</ul>
<h2 id="disadvantages">Disadvantages</h2>
<ul>
<li><p>Hard to implement</p></li>
<li><p>May take a lot of computer time</p></li>
<li><p>May be hard to obtain confidence intervals</p></li>
</ul>
<div id="footer">
	<div style="text-align:center">
		<a href="index.html">Course home page</a>
		&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
		<a href="mailto:bio708qmee@gmail.com">Email the profs</a>
		&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
		<a href="logo.html">Logo information</a>
	</div>
</div>
</body>
</html>
