<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="qmee.css" type="text/css" />
</head>
<body>
<header class="site-header">
<div class="wrapper">
	<h1 class="title">
		<a href="index.html">Biology 708, McMaster University</a>
	</h1>
	<div style="text-align:center">
		<img src="http://imgs.xkcd.com/comics/self_description.png">
	</div>
</div>
</header>
<p>Introduction</p>
<p><code>           The key frequentist question is:</code></p>
<p><code>               could this effect be generated by chance (under the null</code><br />
<code>               hypothesis)</code></p>
<p><code>           Permutation tests provide a natural, intuitive way to test a</code><br />
<code>           wide range of such hypotheses:</code></p>
<p><code>               If we hypothesize that two things are interchangeable, what</code><br />
<code>               happens if we interchange them?</code></p>
<p>Examples</p>
<p><code>   </code><a href="Counting_ant_colonies.html"><code>Counting</code> <code>ant</code> <code>colonies</code></a></p>
<p><code>           We do an exhaustive survey of ant colonies in a forest habitat</code><br />
<code>           and an old-field habitat.  This is how many colonies we find in</code><br />
<code>           each survey plot:</code></p>
<p><code>               Forest: 9, 6, 4, 6, 7, 10</code></p>
<p><code>               Field: 12, 9, 12, 10</code></p>
<p><code>           Field seems to have more ant colonies</code></p>
<p><code>           Could this result be due to chance?</code></p>
<p><code>       Permutation testing</code></p>
<p><code>           Choose a statistic that reflects the effect you are trying to</code><br />
<code>           measure</code></p>
<p><code>               e.g., mean, median, geometric mean</code></p>
<p><code>           Compared the observed value of the statistic with a null</code><br />
<code>           distribution, generated by interchanging things that should be</code><br />
<code>           interchangeable under your null hypothesis</code></p>
<p><code>       Field and forest ants</code></p>
<p><code>           Total of 210 possible permutations</code></p>
<p><code>           5 have ``Field</code> <code>mean</code> <code>-</code> <code>Forest</code> <code>mean`` $$\ge 3.75$$</code></p>
<p><code>           What is our P value?</code></p>
<p><code>       Ties and tails</code></p>
<p><code>           &quot;Ties&quot; (permutations with a statistic equal to the observed</code><br />
<code>           statistic)  </code><em><code>count</code></em><code> against significance</code></p>
<p><code>               Ties are evidence against our observation being unusual</code></p>
<p><code>           The best way to do a two-tailed test is to calculate a</code><br />
<code>           one-tailed P value for the observed effect, and then double</code><br />
<code>           the P value</code></p>
<p><code>               Classic tests assume everything is symmetric, so people</code><br />
<code>               often don't need to think about this point.  And when they</code><br />
<code>               do, they often get it wrong</code></p>
<p><code>       How should we interpret our result?</code></p>
<p><code>           We have assumed nothing about the distribution of ant nests</code></p>
<p><code>           What is the best way to interpret our significant permutation</code><br />
<code>           result?</code></p>
<p><code>           The difference in means we observe (``Field</code> <code>mean`` &gt;</code><br />
<code>           ``Forest</code> <code>mean``) is due to something real about the</code><br />
<code>           systems (ie., not due to chance).</code></p>
<p><code>               </code><em><code>Note:</code></em><code> if we want to conclude that the field mean is</code><br />
<code>               </code><em><code>greater</code></em><code>, we need to assume something about distributions</code></p>
<p><code>               </code><em><code>Note:</code></em><code> we only used one forest habitat and one old-field</code><br />
<code>               habitat.  What does this mean about our conclusions?</code></p>
<p><code>       Which statistic should we use?</code></p>
<p><code>           We can use any statistic we want, and get a valid test</code></p>
<p><code>               Means tend to have more power than medians</code></p>
<p><code>               Transformations that make the data more normal also tend to</code><br />
<code>               increase power</code></p>
<p><code>                   Using the geometric mean is equivalent to what</code><br />
<code>                   transformation?</code></p>
<p><code>           We are not allowed to try different statistics until one</code><br />
<code>           works.  Why not?</code></p>
<p><code>   Ant colony distributions</code></p>
<p><code>           Within each habitat, we can ask whether there is evidence that</code><br />
<code>           ant nests are aggregated, or distributed regularly?</code></p>
<p><code>               In other words, do they cluster, or avoid each other?  Or</code><br />
<code>               can't we tell?</code></p>
<p><code>           A permutation approach would test this by assigning nests</code><br />
<code>           randomly to plots to generate a null distribution</code></p>
<p><code>   Pond nutrients</code></p>
<p><code>           We measure correlations between a species of algae and</code><br />
<code>           nitrogen and phosphorous levels in natural ponds.  Thus, we</code><br />
<code>           have a data frame showing N, P and A (for algae).</code></p>
<p><code>           What kinds of tests could we do to see whether the algae are</code><br />
<code>           correlated with nutrient levels?</code></p>
<p>Methodology</p>
<p><code>   Monte Carlo </code></p>
<p><code>           In the distribution example, we would like to test each</code><br />
<code>           possible random assignment of nests to plots</code></p>
<p><code>           This is impossible (there are too many permutations)</code></p>
<p><code>           We therefore do a few thousand samples at random</code></p>
<p><code>               We can treat this as a valid frequentist test</code></p>
<p><code>               Or we can use classic methods to evaluate our results and</code><br />
<code>               see how confident we are about our P value</code></p>
<p><code>   Correlations</code></p>
<p><code>           With permutation tests, we can use any kind of prediction</code><br />
<code>           model, any statistic of prediction and any null hypothesis</code></p>
<p><code>               Interchange things that should be interchangeable under</code><br />
<code>               null hypothesis</code></p>
<p><code>               How likely is it that we would observe a prediction as good</code><br />
<code>               or better as the one we have, under the null hypothesis</code><br />
<code>               that $$x$$ is interchangeable?</code></p>
<p><code>   Time and space</code></p>
<p><code>           </code><a href="Wikipedia:Mantel_test.html"><code>Mantel</code> <code>tests</code></a><code> are permutation tests</code></p>
<p><code>               So is Fisher's exact test</code></p>
<p><code>           </code><a href="http://www.pnas.org/content/104/18/7717.full"><code>Rabies</code> <code>examples</code></a></p>
<p><code>               </code><a href="Media:Weighted_Mantel.jpg.html"><code>Picture</code></a></p>
<p>More applications</p>
<p><code>       Detailed models of evolution</code></p>
<p><code>           Infer a tree and then ask what happens if we relabel</code><br />
<code>           nucleotides at each site, or move mutations around the tree</code></p>
<p><code>           Ask if there are differences between nucleotide preference in</code><br />
<code>           flu evolution by &quot;relabeling&quot; nucleotides</code></p>
<p><code>       Animal behavior</code></p>
<p><code>           Observe behavior of different individual animals.  Evaluate</code><br />
<code>           observed statistics of (for example) tendency of bachelors to</code><br />
<code>           wander off from groups</code></p>
<p><code>               Classic tests don't account for individual propensities</code></p>
<p><code>               Switch whole &quot;timelines&quot; from one individual to another</code></p>
<p>Confidence intervals</p>
<p><code>           The strength of permutation tests is also a weakness</code></p>
<p><code>           Without assumptions about distributions, it's not possible to</code><br />
<code>           get confidence intervals</code></p>
<p><code>           The field of getting confidence intervals from permutation</code><br />
<code>           tests is still developing</code></p>
<p><code>               Much can be done ...  but not without assumptions</code></p>
<p><code>       Medians</code></p>
<p><code>           Permutation tests are well suited to comparing medians (and</code><br />
<code>           other quantiles), because these can be evaluated without</code><br />
<code>           distributional assumptions</code></p>
<p><code>               This approach is related to rank tests</code></p>
<p><code>       Means</code></p>
<p><code>           We can obtain confidence intervals for a single mean if we</code><br />
<code>           assume that the data are drawn from a symmetric distribution</code></p>
<p><code>               It may be good to transform first</code></p>
<p><code>           We can obtain confidence intervals for the difference between</code><br />
<code>           two means if we assume that the distributions are identical</code><br />
<code>           except for a 'shift'</code></p>
<p><code>               It may be good to transform first</code></p>
<p><code>       Correlations</code></p>
<p><code>           We can obtain confidence intervals for regression coefficients</code><br />
<code>           if we assume that the true relationship between the variables</code><br />
<code>           is linear</code></p>
<p><code>               It may be good to transform first</code></p>
<p>Summary</p>
<p><code>       Advantages:</code></p>
<p><code>           General applicability</code></p>
<p><code>           Conceptual clarity</code></p>
<p><code>           Flexibility</code></p>
<p><code>           Fewer assumptions</code></p>
<p><code>       Disadvantages</code></p>
<p><code>           Hard to implement</code></p>
<p><code>           May take a lot of computer time</code></p>
<p><code>           May be hard to obtain confidence intervals</code></p>
<div id="footer">
	<div style="text-align:center">
		<a href="index.html">Course home page</a>
		&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
		<a href="mailto:bio708qmee@gmail.com">Email the profs</a>
		&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
		<a href="logo.html">Logo information</a>
	</div>
</div>
</body>
</html>
