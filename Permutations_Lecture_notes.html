<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Jonathan Dushoff" />
  <title>Permutations lecture</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="qmee.css" type="text/css" />
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>
<body>
<header class="site-header">
<div class="wrapper">
	<h1 class="title">
		<a href="index.html">Biology 708, McMaster University</a>
	</h1>
	<div style="text-align:center">
		<img src="http://imgs.xkcd.com/comics/self_description.png">
	</div>
</div>
</header>
<div id="header">
<h1 class="title">Permutations lecture</h1>
<h2 class="author">Jonathan Dushoff</h2>
</div>
<h1 id="introduction">Introduction</h1>
<h2 id="permutation-approach">Permutation approach</h2>
<ul>
<li><p>The key frequentist question is:</p>
<ul>
<li>could this effect be generated by chance (under the null hypothesis)</li>
</ul></li>
<li><p>Permutation tests provide a natural, intuitive way to test a wide range of such hypotheses:</p>
<ul>
<li>If we hypothesize that two things are interchangeable, what happens if we interchange them?</li>
</ul></li>
</ul>
<h1 id="examples">Examples</h1>
<h2 id="counting-ant-colonies">Counting ant colonies</h2>
<ul>
<li><p>We do an exhaustive survey of ant colonies in a forest habitat and an old-field habitat. This is how many colonies we find in each survey plot:</p>
<ul>
<li><p>Forest: 9, 6, 4, 6, 7, 10</p></li>
<li><p>Field: 12, 9, 12, 10</p></li>
</ul></li>
<li><p>Field seems to have more ant colonies</p></li>
<li><p>Could this result be due to chance?</p></li>
</ul>
<h2 id="permutation-testing">Permutation testing</h2>
<ul>
<li><p>Choose a statistic that reflects the effect you are trying to measure</p>
<ul>
<li>e.g., mean, median, geometric mean</li>
</ul></li>
<li><p>Compared the observed value of the statistic with a null distribution, generated by interchanging things that should be interchangeable under your null hypothesis</p></li>
</ul>
<h2 id="field-and-forest-ants">Field and forest ants</h2>
<ul>
<li><p>Total of 210 possible permutations</p></li>
<li><p>5 have <code>Field mean - Forest mean</code> <span class="math inline">\(\ge 3.75\)</span></p></li>
<li><p>What is our P value?</p></li>
</ul>
<h2 id="ties-and-tails">Ties and tails</h2>
<ul>
<li><p>“Ties” (permutations with a statistic equal to the observed statistic) “count” against significance</p>
<ul>
<li>Ties are evidence against our observation being unusual</li>
</ul></li>
<li><p><em>Opinion:</em> The best way to do a two-tailed test is to calculate a one-tailed P value for the observed effect, and then double the P value</p>
<ul>
<li>Classic tests assume everything is symmetric, so people often don’t need to think about this point. <em>And when they do, they often get it wrong.</em></li>
</ul></li>
</ul>
<h2 id="how-should-we-interpret-our-result">How should we interpret our result?</h2>
<ul>
<li><p>We have assumed nothing about the distribution of ant nests</p></li>
<li><p>What is the best way to interpret our significant permutation result?</p></li>
<li><p>The difference in means we observe (<code>Field mean</code> &gt; <code>Forest mean</code>) is due to <em>something</em> real about the systems (ie., not due to chance).</p>
<ul>
<li><p>If we want to conclude that the field mean is “greater”, we need to assume something about distributions</p></li>
<li><p>We only used one forest habitat and one old-field habitat. What does this mean about our conclusions?</p></li>
</ul></li>
</ul>
<h2 id="which-statistic-should-we-use">Which statistic should we use?</h2>
<ul>
<li><p>We can use any statistic we want, and get a valid test</p>
<ul>
<li><p>Means tend to have more power than medians</p></li>
<li><p>Transformations that make the data more normal also tend to increase power</p></li>
<li><p>Using the geometric mean is equivalent to what transformation?</p></li>
</ul></li>
<li><p>We are not allowed to try different statistics until one works. Why not?</p></li>
</ul>
<h1 id="the-power-of-permutations">The power of permutations</h1>
<h2 id="test-what-you-want">Test what you want</h2>
<ul>
<li><p>You can test anything, if you can:</p>
<ul>
<li><p>Measure it with a statistic</p></li>
<li><p>Come up with a permutation approach that reflects a scientific question</p></li>
</ul></li>
</ul>
<h2 id="ant-colony-distributions">Ant colony distributions</h2>
<ul>
<li><p>Within each habitat, we can ask whether there is evidence that ant nests are aggregated, or distributed regularly?</p>
<ul>
<li>In other words, do they cluster, or avoid each other? Or can’t we tell?</li>
</ul></li>
<li><p>A permutation approach would test this by assigning nests randomly to plots to generate a null distribution</p></li>
</ul>
<h2 id="pond-nutrients">Pond nutrients</h2>
<ul>
<li><p>We measure correlations between a species of algae and nitrogen and phosphorous levels in natural ponds. Thus, we have a data frame showing N, P and A (for algae).</p></li>
<li><p>What kinds of tests could we do to see whether the algae are correlated with nutrient levels?</p></li>
</ul>
<h1 id="methodology">Methodology</h1>
<h2 id="monte-carlo">Monte Carlo</h2>
<ul>
<li><p>In the distribution example, we would like to test each possible random assignment of nests to plots</p></li>
<li><p>This is impossible (there are too many permutations)</p></li>
<li><p>We therefore do a few thousand samples at random</p>
<ul>
<li><p>We can treat this as a valid frequentist test</p></li>
<li><p>Or we can use classic methods to evaluate our results and see how confident we are about our P value</p></li>
</ul></li>
</ul>
<h2 id="correlations">Correlations</h2>
<ul>
<li><p>With permutation tests, we can use any kind of prediction model, any statistic of prediction and any null hypothesis</p>
<ul>
<li><p>Interchange things that should be interchangeable under null hypothesis</p></li>
<li><p>How likely is it that we would observe a prediction as good or better as the one we have, under the null hypothesis that <span class="math inline">\(x\)</span> is interchangeable?</p></li>
</ul></li>
</ul>
<h2 id="time-and-space">Time and space</h2>
<ul>
<li><p><a href="https://en.wikipedia.org/wiki/Mantel_test">Mantel tests</a> are permutation tests</p>
<ul>
<li>So is <a href="https://en.wikipedia.org/wiki/Fisher%27s_exact_test">Fisher’s exact test</a> (this has a weird approach to P values, and JD doesn’t like it)</li>
</ul></li>
<li><p><a href="http://www.pnas.org/content/104/18/7717.full">Rabies examples</a></p></li>
</ul>
<p><a href="http://lalashan.mcmaster.ca/theobio/bio_708/images/d/d9/Weighted_Mantel.jpg"><img src="http://lalashan.mcmaster.ca/theobio/bio_708/images/d/d9/Weighted_Mantel.jpg" alt="Cross-country correlation" /></a></p>
<h1 id="more-applications">More applications</h1>
<h2 id="detailed-models-of-evolution">Detailed models of evolution</h2>
<ul>
<li><p>Infer a tree and then ask what happens if we relabel nucleotides at each site, or move mutations around the tree</p></li>
<li><p>Ask if there are differences between nucleotide preference in flu evolution by “relabeling” nucleotides</p></li>
</ul>
<h2 id="animal-behavior">Animal behavior</h2>
<ul>
<li><p>Observe behavior of different individual animals. Evaluate observed statistics of (for example) tendency of bachelors to wander off from groups</p>
<ul>
<li><p>Classic tests don’t account for individual propensities</p></li>
<li><p>Switch whole “timelines” from one individual to another</p></li>
</ul></li>
</ul>
<h1 id="confidence-intervals">Confidence intervals</h1>
<h2 id="assumptions">Assumptions</h2>
<ul>
<li><p>The strength of permutation tests is also a weakness</p></li>
<li><p>Without assumptions about distributions, it’s not possible to get confidence intervals</p></li>
<li><p>The field of getting confidence intervals from permutation tests is still developing</p>
<ul>
<li>Much can be done … but not without assumptions</li>
</ul></li>
</ul>
<h2 id="medians">Medians</h2>
<ul>
<li><p>Permutation tests are well suited to comparing medians (and other quantiles), because these can be evaluated without distributional assumptions</p>
<ul>
<li>This approach is related to rank tests</li>
</ul></li>
</ul>
<h2 id="means">Means</h2>
<ul>
<li><p>We can obtain confidence intervals for a single mean if we assume that the data are drawn from a symmetric distribution</p>
<ul>
<li>It may be good to transform first</li>
</ul></li>
<li><p>We can obtain confidence intervals for the difference between two means if we assume that the distributions are identical except for a ‘shift’</p>
<ul>
<li>It may be good to transform first</li>
</ul></li>
</ul>
<h2 id="correlations-1">Correlations</h2>
<ul>
<li><p>We can obtain confidence intervals for regression coefficients if we assume that the true relationship between the variables is linear</p>
<ul>
<li>It may be good to transform first</li>
</ul></li>
</ul>
<h1 id="summary">Summary</h1>
<h2 id="advantages">Advantages:</h2>
<ul>
<li><p>General applicability</p></li>
<li><p>Conceptual clarity</p></li>
<li><p>Flexibility</p></li>
<li><p>Fewer assumptions</p></li>
</ul>
<h2 id="disadvantages">Disadvantages</h2>
<ul>
<li><p>Hard to implement</p></li>
<li><p>May take a lot of computer time</p></li>
<li><p>May be hard to obtain confidence intervals</p></li>
</ul>
<div id="footer">
	<div style="text-align:center">
		<a href="index.html">Course home page</a>
		&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
		<a href="mailto:bio708qmee@gmail.com">Email the profs</a>
		&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
		<a href="logo.html">Logo information</a>
	</div>
</div>
</body>
</html>
