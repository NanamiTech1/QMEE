<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Jonathan Dushoff and Ben Bolker" />
  <title>Mixed models</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="qmee.css" type="text/css" />
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
</head>
<body>
<header class="site-header">
<div class="wrapper">
	<h1 class="title">
		<a href="index.html">Biology 708, McMaster University</a>
	</h1>
	<div style="text-align:center">
		<img src="http://imgs.xkcd.com/comics/self_description.png">
	</div>
</div>
</header>
<div id="header">
<h1 class="title">Mixed models</h1>
<h2 class="author">Jonathan Dushoff and Ben Bolker</h2>
</div>
<h2 id="resources">Resources</h2>
<ul>
<li><p><a href="Mixed_models_Classic_approach.html">classic ANOVA approach</a> to mixed models.</p></li>
<li><p><a href="https://github.com/mac-theobio/QMEE_2017/blob/master/papers/14-Fox-Chap13_ed.pdf">Bolker chapter from Fox et al.</a> (on private repo, you need to be signed in)</p></li>
</ul>
<h2 id="intro">Intro</h2>
<p>Mixed models are models which combine “random” and “fixed” effects.</p>
<ul>
<li>Fixed effects are effects whose parameters we wish to estimate
<ul>
<li>The slope of a phosphorous response</li>
<li>The difference in shield thickness between males and females</li>
</ul></li>
<li>Random effects are effects that we wish to account for without estimating individually
<ul>
<li>Neuron identity</li>
<li>Village of residence</li>
</ul></li>
</ul>
<h2 id="modern-and-classic-approaches">Modern and classic approaches</h2>
<p>“Modern” approach to mixed models involves explicitly estimating “random” parameters and their variances (see below).</p>
<p>Compared to the <a href="Mixed_models_Classic_approach.html">classic ANOVA approach</a> to mixed models, the modern approach is:</p>
<ul>
<li>conceptually clear</li>
<li>flexible</li>
<li>powerful</li>
<li>computationally difficult</li>
</ul>
<h2 id="example">Example</h2>
<p>Testing the effects of acid rain on spruce tree growth.</p>
<p>We have a complex manipulation (what kind of air the trees are exposed to). As a result:</p>
<ul>
<li>We have a small number of trees</li>
<li>We take a lot of samples from each tree</li>
<li>“Treatment” is a fixed effect
<ul>
<li>We want to estimate the difference in growth with clean air and dirty air</li>
</ul></li>
<li>“Tree” is a random effect
<ul>
<li>We want to know what about the <em>distribution</em> of tree effects (so we can control for it); we are not specifically interested in the difference in growth between tree 3 and tree 5</li>
</ul></li>
</ul>
<h2 id="random-effects">Random effects</h2>
<p>Random effects are typically based on unordered factors</p>
<ul>
<li>the levels of the factor are conceptualized as random samples from a larger population</li>
<li>the effect of each level is therefore a random variable</li>
<li>the essential parameters we estimate are not the effect of each level, but the mean and variance of the <em>distribution</em>.</li>
</ul>
<h2 id="is-this-a-random-effect">Is this a random effect?</h2>
<p>Treating something as a random effect means treating the levels as interchangeable from the point of view of your scientific hypothesis.</p>
<p>There is sometimes controversy about when it is appropriate to model a predictor using random effects. Here are some criteria …</p>
<h2 id="philosophical-questions">philosophical questions</h2>
<ul>
<li>are the levels chosen from a larger population?</li>
<li>are the levels chosen randomly?</li>
<li>are the levels a non-exhaustive sample of possible levels?</li>
<li>do you want to be able to make predictions about new (unobserved) levels?
<ul>
<li>or inferences that include them?</li>
</ul></li>
<li>are you interested in the distribution of levels/variability among levels?</li>
<li>are you <em>uninterested</em> in testing hypotheses about specific levels?</li>
</ul>
<h2 id="types-of-analysis">Types of analysis</h2>
<p>There are several terms of art that are often used as synonyms for mixed models</p>
<ul>
<li>repeated measures
<ul>
<li>individual identity would typically be associated with a random effect</li>
</ul></li>
<li>multilevel or hierarchical models
<ul>
<li>each identifiable level could have its own random effect: e.g., country, village, household</li>
</ul></li>
</ul>
<h2 id="inferential-questions">inferential questions</h2>
<p>The choice to make something a random effect often has more effect on your inferences about <em>other</em> variables than on your inferences about the focal variable</p>
<ul>
<li>Inferring using a fixed effect means we are inferring across the group of levels we have measured (only)</li>
<li>Inferring using a random effect means we are inferring across a <em>population represented by</em> the group of levels we have measured</li>
</ul>
<h2 id="examples">Examples</h2>
<p>We measure effects of an influenza vaccination experiment for several years</p>
<ul>
<li>Year as a fixed effect: did vaccination “help” on average over these years (with a particular set of flu strains, etc.</li>
<li>Year as random effect: will vaccination “help” on average over a wider set of years (assuming observed years are representative)</li>
</ul>
<p>Spruce trees</p>
<ul>
<li>May not have enough data to do a random effects analysis</li>
<li>Our <em>statistical</em> inference is then limited to the areas we studied</li>
<li>Whether we can broaden our <em>scientific</em> inference is a science question (not stats)</li>
</ul>
<h2 id="practical-questions">Practical questions</h2>
<ul>
<li>Modern methods
<ul>
<li>have you measured a sufficient number of levels to estimate a variance (&gt;5, preferably &gt;10)?</li>
<li>May need more for more complicated models</li>
</ul></li>
<li>Classic methods
<ul>
<li>Do you have a balanced design?</li>
</ul></li>
<li>Otherwise
<ul>
<li>Limit your inference</li>
<li>Try an even more advanced approach (usually Bayesian)</li>
</ul></li>
</ul>
<h2 id="interactions">Interactions</h2>
<ul>
<li>Are only intercepts affected by random factors, or also responses?
<ul>
<li>e.g., spruce trees</li>
</ul></li>
<li>Interactions are often conceptually appealing, but computationally challenging</li>
</ul>
<h2 id="fitting">Fitting</h2>
<p>Modern mixed-model packages (see below) can fit a wide variety of models. You just need to specify which effects are random.</p>
<ul>
<li>Works with unbalanced designs</li>
<li>Works with crossed random effects</li>
<li>May require a lot of data (and sometimes a lot of levels) for a reliable fit
<ul>
<li>Depends on model complexity</li>
</ul></li>
</ul>
<h2 id="too-few-levels">Too few levels</h2>
<p>If you have something that should be a random-effect predictor, but you don’t have enough levels, you can’t fit a mixed model</p>
<p>It’s OK to treat your random effect as a fixed effect, as long as this is properly reflected in your scientific conclusions.</p>
<ul>
<li>The scope of your analysis covers only the sampled levels, not the population they were sampled from</li>
</ul>
<h2 id="r-side-effects">R-side effects</h2>
<p>Some effects can be modeled effectively with MMMs (modern mixed models) on the “residual (R) side”.</p>
<p>Standard random effects</p>
<ul>
<li>Discrete groups: any relation is binary
<ul>
<li>You and I are in the same country, but not the same village</li>
</ul></li>
</ul>
<p>R-side effects</p>
<ul>
<li>Arbitrary variance-covariance structure (time, space, etc.)
<ul>
<li>I am very close to Ben, and sort of close to Morgan</li>
</ul></li>
<li>Can also allow for heteroscedasticity</li>
</ul>
<h2 id="how-it-works">How it works</h2>
<p>It’s complicated!</p>
<h2 id="how-it-works-1">How it works</h2>
<p>Typically based on <em>marginal likelihood</em>: probability of observing outcomes.</p>
<p>Balance (dispersion of RE around 0) with (dispersion of data conditional on RE)</p>
<p><strong>Shrinkage</strong>: estimated values get “shrunk” toward the overall mean, especially in small-sample/extreme units</p>
<h2 id="how-do-we-do-it">How do we do it?</h2>
<p>Different for linear mixed models (LMMs: normally distributed response) and generalized linear mixed models (GLMMs: binomial, Poisson, etc.)</p>
<ul>
<li>LMMs: REML vs ML
<ul>
<li>analogy: <span class="math inline">\(n-1\)</span> in estimation of variance</li>
<li>analogy: paired <span class="math inline">\(t\)</span>-test</li>
<li>what do I do when I have more than 2 treatment levels per block?</li>
</ul></li>
<li>GLMMs: PQL, Laplace, Gauss-Hermite</li>
<li>Bayesian approach: put a combined prior on the parameters</li>
</ul>
<h2 id="practical-details-in-r">Practical details in R</h2>
<ul>
<li><code>aov + Error()</code> term: <em>classical</em> designs</li>
<li><code>lme</code> (<code>nlme</code> package): older, better documented, more stable, does R-side models, complex variance structures, gives denominator df/<span class="math inline">\(p\)</span> values</li>
<li><code>(g)lmer</code> (<code>lme4</code> package): newer, faster, does crossed random effects, GLMMs</li>
<li>many other special-purpose packages</li>
</ul>
<p><a href="Mixed_models_examples.html">examples</a></p>
<div id="footer">
	<div style="text-align:center">
		<a href="index.html">Course home page</a>
		&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
		<a href="mailto:bio708qmee@gmail.com">Email the profs</a>
		&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
		<a href="logo.html">Logo information</a>
	</div>
</div>
</body>
</html>
